{% extends "partials/base.html" %}

{% load static %}
{% block content%} 

<main class="main" id="cart-list">
    <div class="page-header breadcrumb-wrap">
        <div class="container">
            <div class="breadcrumb">
                <a href="index.html" rel="nofollow">Home</a>
                <span></span> Shop
                <span></span> Your Cart
            </div>
        </div>
    </div>
    <section class="mt-50 mb-50">
        {% if not cart_items %}
        <h2 class="text-center">your shopping cart is empty!!!</h2>
        <br>
        <div class="text-center">
            <a href="{% url "app:index" %}" class="btn btn-primary">Continue shopping</a>
        </div>
        {% else %}
       <div class="container">
            <div class="row">
                <div class="col-12">
                    <div class="table-responsive">
                        <table class="table shopping-summery text-center clean">
                            <thead>
                                <tr class="main-heading">
                                    <th scope="col">Image</th>
                                    <th scope="col">Name</th>
                                    <th scope="col">Price</th>
                                    <th scope="col" class="text-center">Quantity</th>
                                    <th scope="col">Subtotal</th>
                                    {% comment %} <th scope="col">Refresh</th> {% endcomment %}
                                    <th scope="col">Remove</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% comment %} {% for product_id,item in cart_data.items  %}
                                <tr>
                                    <td class="image product-thumbnail"><img src="{{item.image}}" alt="#"></td>
                                    <td class="product-des product-name">
                                        <h5 class="product-name"><a href=" {% url "app:product_detail" item.pid %}">{{item.title}}</a></h5>
                                        <p class="font-xs">Maboriosam in a tonto nesciung eget<br> distingy magndapibus.
                                        </p>
                                    </td>
                                    <td class="price" data-title="Price"><span><span>₹</span>{{item.price|floatformat:2}}</span></td>
                                    <td class="text-center detail-info" data-title="Stock">
                                        <div class="m-15">
                                            {% comment %} <a href="#" class="qty-down"><i class="fi-rs-angle-small-down"></i></a>
                                            <span class="qty-val">1</span>
                                            <a href="#" class="qty-up"><i class="fi-rs-angle-small-up"></i></a> {% endcomment %}
                                            {% comment %} <input type="number" placeholder="Qty" value="{{item.qty}}" class="W-50">
                                        </div>
                                    </td>
                                    <td class="text-right" data-title="Cart">
                                        <span>₹{% widthratio item.price 1 item.qty %}</span>
                                    </td>
                                    <td class="action" data-title="Refresh"><a href="#" class="text-muted"><i class="fi-rs-refresh"></i></a></td>
                                    <td class="action" data-title="Remove">
                                        <button style="border:none; background:none;" class="text-body delete-product" data-product="{{ product_id }}">
                                            <i class="fi-rs-trash"></i>
                                        </button>
                                    </td> 
                             </tr>
                                {% endfor %} {% endcomment %} 
                                {% for item in cart_items %}
<tr>
    <td class="image product-thumbnail"><img src="{{ item.product.image.url }}" alt="#"></td>
    <td class="product-des product-name">
      
        <h5 class="product-name"><a href="{% url 'app:product_detail' item.product.pid %}">{{ item.product.title }}</a></h5>
        <p class="font-xs">
            {% if item.variations.all %}
                <p>yes</p>
                {% for iteme in item.variations.all %}
                    <li>Size:{{ iteme.size|upper }}</li>
                {% endfor %}
           {% endif %}
        
            </p>

    </td>
   

   <td class="price" data-title="Price"><span><span>₹</span>{{ item.product.price|floatformat:2 }}</span></td>
     {% comment %} <td class="text-center detail-info" data-title="Stock">
        <div class="m-15">
            <a href=" {% url "cart:add_cart" item.product.pid %}" type="number" placeholder="Qty" value="{{ item.quantity }}" class="W-50"></a>
        </div>
    </td> {% endcomment %}

<td>
  
    <div class="input-group">
        <a href="{% url 'cart:remove_cart' item.product.pid item.id %}" class="btn btn-outline-secondary" type="button" id="button-minus"><i class="fa fa-minus"></i></a>
        <input type="text" class="form-control" value="{{ item.quantity }}" aria-label="Item quantity">
       <form action="{% url 'cart:add_cart' item.product.pid %}" method="POST">
        {% csrf_token %}
        {% for item in item.variations.all  %}
        <input type='hidden' name="size" value="{{item.size}}">
        {% endfor %}
        <button class="btn btn-outline-secondary" type="submit" id="button-plus"><i class="fa fa-plus"></i></button>

    </form>
    </div>
</td>   




    <td class="text-right" data-title="Cart"><span>₹{{ item.sub_total }}</span></td>
    {% comment %} <td class="action" data-title="Refresh"><a href="#" class="text-muted"><i class="fi-rs-refresh"></i></a></td> {% endcomment %}
    <td class="action" data-title="Remove">
        <a href="{% url 'cart:remove_cart_item' item.product.pid item.id %}" onclick="return confirm('Are you sure u want to delete this item?')" style="border:none; background:none;" class="text-body delete-product" >
            <i class="fi-rs-trash"></i>
        </a>
    </td> 
</tr>
{% endfor %}
                                <tr>
                                    <td colspan="6" class="text-end">
                                        <a href="#" class="text-muted"> <i class="fi-rs-cross-small"></i> Clear Cart</a>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="cart-action text-end">
                        <a class="btn  mr-10 mb-sm-15"><i class="fi-rs-shuffle mr-10"></i>Update Cart</a>
                        <a href="{% url "app:index" %}" class="btn "><i class="fi-rs-shopping-bag mr-10"></i>Continue Shopping</a>
                    </div>
                    <div class="divider center_icon mt-50 mb-50"><i class="fi-rs-fingerprint"></i></div>
                    <div class="row mb-50">
                        <div class="col-lg-6 col-md-12">
                           
                            <div class="mb-30 mt-50">
                                <div class="heading_s1 mb-3">
                                    <h4>Apply Coupon</h4>
                                </div>
                                <div class="total-amount">
                                    <div class="left">
                                        <div class="coupon">
                                            <form action="#" target="_blank">
                                                <div class="form-row row justify-content-center">
                                                    <div class="form-group col-lg-6">
                                                        <input class="font-medium" name="Coupon" placeholder="Enter Your Coupon">
                                                    </div>
                                                    <div class="form-group col-lg-6">
                                                        <button class="btn  btn-sm"><i class="fi-rs-label mr-10"></i>Apply</button>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-6 col-md-12">
                            <div class="border p-md-4 p-30 border-radius cart-totals">
                                <div class="heading_s1 mb-3">
                                    <h4>Cart Totals</h4>
                                </div>
                                <div class="table-responsive">
                                    <table class="table">
                                        <tbody>
                                            <tr>
                                                <td class="cart_total_label">Cart Subtotal</td>
                                                <td class="cart_total_amount"><span class="font-lg fw-900 text-brand">₹{{total}}</span></td>
                                            </tr>
                                            <tr>
                                                <td class="cart_total_label">Shipping</td>
                                                <td class="cart_total_amount"> <i class="ti-gift mr-5"></i>₹{{shipping}}</td>
                                            </tr>
                                            {% if offer_price %}
                                            <tr>
                                                <th>Offer</th>
                                                <td colspan="2"><em>-{{offer_price}}</em></td>
                                            </tr>
                                            {% endif %}
                                            <tr>
                                                <td class="cart_total_label">Total</td>
                                                <td class="cart_total_amount"><strong><span class="font-xl fw-900 text-brand">₹{{grand_total|floatformat:2}}</span></strong></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                {% comment %} {% if totalcartitems %} {% endcomment %}
                                   <a href="{% url "cart:Checkout" %}" class="btn "> <i class="fi-rs-box-alt mr-10"></i> Proceed To CheckOut</a>
                                {% comment %} {% endif %} {% endcomment %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        {% endif %}
    </section>
</main>

{% endblock content %}